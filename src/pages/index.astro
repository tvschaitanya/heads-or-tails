---
// src/pages/index.astro
import '../styles/global.css';
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Secure and Modern Coin Flip Simulator">
  <title>Heads or Tails</title>
</head>
<body>

  <div class="app-card">
    <section class="game-section">
      <div class="header">
        <h1>Heads or Tails?</h1>
        <p>Find out the answer!</p>
      </div>

      <div class="coin-stage">
        <div id="coin" class="coin">
          <div class="face front">H</div>
          <div class="face back">T</div>
        </div>
      </div>

      <div id="resultLabel" class="result-text">Ready</div>

      <div class="controls">
        <button id="flipBtn" class="btn">Flip Coin</button>
      </div>
    </section>

    <section class="sidebar">
      <div class="stats-row">
        <div class="stat-item">
          <span id="statHeads" class="stat-value" style="color: var(--color-heads)">0</span>
          <span class="stat-label">Heads</span>
        </div>
        <div class="stat-item">
          <span id="statTotal" class="stat-value">0</span>
          <span class="stat-label">Total</span>
        </div>
        <div class="stat-item">
          <span id="statTails" class="stat-value" style="color: var(--color-tails)">0</span>
          <span class="stat-label">Tails</span>
        </div>
      </div>

      <div class="history-container">
        <div class="history-header">
          <span class="history-title">History Timeline</span>
          <button id="resetBtn" class="btn-reset">Reset All</button>
        </div>

        <div class="timeline-scroll">
          <div id="timelineList" class="timeline">
            <div class="empty-state">No flips yet.</div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    import { CoinFlipApp } from '../scripts/flip.js';

    let app = null;

    function init() {
      if (!app) {
        app = new CoinFlipApp();
      }
    }

    // Handle view transitions or standard load
    document.addEventListener('astro:page-load', init);
    
    // Fallback for non-View Transition setups
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html>